{
  "summary_collect_rule":[{
      "matcher":"all_require",
      "collect_name":"all_require",
      "enable":true
    },{
      "matcher":"uri_509",
      "collect_name":"uri_509",
      "enable":true
    },{
      "matcher":"http_referer_509",
      "collect_name":"http_referer",
      "enable":true
    },{
      "matcher":"method_444",
      "collect_name":"method_head",
      "enable":true
    },{
      "matcher":"query_string_507",
      "collect_name":"query_sting",
      "enable":true
    },{
      "matcher":"request_uri_504",
      "collect_name":"request_uri",
      "enable":true
    },{
      "matcher":"sql_query_string",
      "collect_name":"sql_query_sting",
      "enable":true
    },{
      "matcher":"useragent",
      "collect_name":"useragent",
      "enable":true
    },{
      "matcher":"verynginx",
      "collect_name":"verynginx",
      "enable":true
    },{
      "matcher":"waf_agent",
      "collect_name":"waf_agent",
      "enable":true
    },{
      "matcher":"waf_args_1",
      "collect_name":"waf_args_1",
      "enable":true
    },{
      "matcher":"waf_cookie",
      "collect_name":"waf_cookie",
      "enable":true
    },{
      "matcher":"waf_post",
      "collect_name":"waf_post",
      "enable":true
    },{
      "matcher":"waf_url_args",
      "collect_name":"waf_url_args",
      "enable":true
    }],
  "summary_collect_enable":true,
  "static_file_rule":[],
  "filter_enable":true,
  "summary_temporary_period":60,
  "summary_with_host":true,
  "static_file_enable":false,
  "uri_rewrite_enable":false,
  "redirect_enable":false,
  "summary_group_temporary_enable":false,
  "admin":[{
      "user":"verynginx",
      "password":"verynginx",
      "enable":true
    }],
  "uri_rewrite_rule":[],
  "scheme_lock_rule":[{
      "scheme":"https",
      "enable":false,
      "matcher":"verynginx"
    }],
  "proxy_pass_enable":false,
  "cookie_prefix":"verynginx",
  "filter_rule":[{
      "enable":true,
      "custom_response":true,
      "code":"505",
      "matcher":"waf_args_1",
      "response":"firewall_html",
      "action":"block"
    },{
      "enable":true,
      "custom_response":true,
      "code":"505",
      "matcher":"waf_cookie",
      "response":"firewall_html",
      "action":"block"
    },{
      "enable":true,
      "custom_response":true,
      "code":"505",
      "matcher":"waf_post",
      "response":"firewall_html",
      "action":"block"
    },{
      "enable":true,
      "custom_response":true,
      "code":"505",
      "matcher":"waf_url_args",
      "response":"firewall_html",
      "action":"block"
    },{
      "enable":true,
      "custom_response":false,
      "code":"444",
      "matcher":"waf_agent",
      "action":"block"
    },{
      "enable":true,
      "custom_response":false,
      "code":"444",
      "matcher":"useragent",
      "action":"block"
    },{
      "enable":true,
      "custom_response":false,
      "code":"444",
      "matcher":"http_referer_509",
      "action":"block"
    },{
      "enable":true,
      "custom_response":true,
      "code":"504",
      "matcher":"request_uri_504",
      "response":"firewall_html",
      "action":"block"
    },{
      "enable":true,
      "custom_response":true,
      "code":"509",
      "matcher":"uri_509",
      "response":"firewall_html",
      "action":"block"
    },{
      "enable":false,
      "custom_response":true,
      "code":"444",
      "matcher":"method_444",
      "action":"block"
    },{
      "enable":false,
      "custom_response":true,
      "code":"507",
      "matcher":"query_string_1",
      "response":"firewall_html",
      "action":"block"
    },{
      "enable":true,
      "custom_response":true,
      "code":"507",
      "matcher":"query_string_2",
      "response":"firewall_html",
      "action":"block"
    },{
      "enable":true,
      "custom_response":true,
      "code":"507",
      "matcher":"query_string_3",
      "response":"firewall_html",
      "action":"block"
    },{
      "enable":true,
      "custom_response":true,
      "code":"507",
      "matcher":"query_string_4",
      "response":"firewall_html",
      "action":"block"
    },{
      "enable":true,
      "custom_response":true,
      "code":"507",
      "matcher":"query_string_5",
      "response":"firewall_html",
      "action":"block"
    },{
      "enable":true,
      "custom_response":true,
      "code":"507",
      "matcher":"query_string_6",
      "response":"firewall_html",
      "action":"block"
    },{
      "enable":true,
      "custom_response":true,
      "code":"507",
      "matcher":"query_string_7",
      "response":"firewall_html",
      "action":"block"
    },{
      "enable":true,
      "custom_response":true,
      "code":"507",
      "matcher":"query_string_8",
      "response":"firewall_html",
      "action":"block"
    },{
      "enable":true,
      "custom_response":true,
      "code":"507",
      "matcher":"query_string_9",
      "response":"firewall_html",
      "action":"block"
    },{
      "enable":true,
      "custom_response":true,
      "code":"200",
      "matcher":"query_string_10",
      "response":"firewall_html",
      "action":"block"
    },{
      "enable":true,
      "custom_response":true,
      "code":"507",
      "matcher":"query_string_11",
      "response":"firewall_html",
      "action":"block"
    },{
      "enable":true,
      "custom_response":true,
      "code":"507",
      "matcher":"query_string_12",
      "response":"firewall_html",
      "action":"block"
    },{
      "enable":true,
      "custom_response":true,
      "code":"507",
      "matcher":"query_string_13",
      "response":"firewall_html",
      "action":"block"
    }],
  "base_uri":"/verynginx",
  "summary_request_enable":true,
  "frequency_limit_rule":[{
      "time":"10",
      "enable":false,
      "count":"10",
      "code":"521",
      "custom_response":true,
      "matcher":"all_require",
      "response":"ccdeny_html",
      "separate":["uri"]
    }],
  "backend_upstream":{
  },
  "redirect_rule":[],
  "scheme_lock_enable":false,
  "browser_verify_enable":false,
  "browser_verify_rule":[],
  "proxy_pass_rule":[],
  "frequency_limit_enable":true,
  "summary_group_persistent_enable":true,
  "matcher":{
    "all_require":{
      "IP":{
        "value":"127.0.0.1",
        "operator":"!="
      }
    },
    "query_string_1":{
      "Args":{
        "value":"(<|%3C).*script.*(>|%3E)",
        "operator":"≈",
        "name_operator":"*"
      }
    },
    "query_string_10":{
      "Args":{
        "value":"b(ultram|unicauca|valium|viagra|vicodin|xanax|ypxaieo)b",
        "operator":"≈",
        "name_operator":"*"
      }
    },
    "query_string_8":{
      "Args":{
        "value":"[a-zA-Z0-9_]=(\\.\\.//?)+",
        "operator":"≈",
        "name_operator":"*"
      }
    },
    "query_string_9":{
      "Args":{
        "value":"[a-zA-Z0-9_]=/([a-z0-9_.]//?)+",
        "operator":"≈",
        "name_operator":"*"
      }
    },
    "query_string_11":{
      "Args":{
        "value":"b(erections|hoodia|huronriveracres|impotence|levitra|libido)b",
        "operator":"≈",
        "name_operator":"*"
      }
    },
    "uri_509":{
      "Args":{
        "value":" (\\/\\.+)|(\\.+\\/)",
        "operator":"≈",
        "name_operator":"*"
      }
    },
    "waf_agent":{
      "UserAgent":{
        "value":"HTTrack|harvest|audit|dirbuster|pangolin|nmap|sqln|-scan|hydra|Parser|libwww|BBBike|sqlmap|w3af|owasp|Nikto|fimap|havij|PycURL|zmeu|BabyKrokodil|netsparker|httperf|bench",
        "operator":"≈"
      }
    },
    "useragent":{
      "UserAgent":{
        "value":"YisouSpider|ApacheBench*|WebBench*|Jmeter|JoeDog|Havij|GetRight|TurnitinBot|GrabNet|masscan|mail2000|github|wget|curl|Java|python|Go-Ahead-Got-It|GetWeb!|Go!Zilla|Download Demon|Indy Library|libwww-perl|Nmap Scripting Engine|bot|~17ce.com|nmap|w3af|netsparker|nikto|fimap|Go-Ahead-Got-It|GetWeb!|Go!Zilla|Download Demon|Indy Library|libwww-perl|Nmap Scripting Engine|~17ce.com",
        "operator":"≈"
      }
    },
    "sql_query_string":{
      "Args":{
        "value":"(\\$|'|--|[+|(%20)]union[+|(%20)]|[+|(%20)]insert[+|(%20)]|[+|(%20)]drop[+|(%20)]|[+|(%20)]truncate[+|(%20)]|[+|(%20)]update[+|(%20)]|[+|(%20)]from[+|(%20)]|[+|(%20)]gra nt[+|(%20)]|[+|(%20)]exec[+|(%20)]|[+|(%20)]where[+|(%20)]|[+|(%20)]select[+|(%20)]|[+|(%20)]and[+|(%20)]|[+|(%20)]or[+|(%20)]|[+|(%20)]count[+|(%20)]|[+|(%20)]exec[+|(%20)]|[+|(%20)]chr[+| (%20)]|[+|(%20)]mid[+|(%20)]|[+|(%20)]like[+|(%20)]|[+|(%20)]iframe[+|(%20)]|[\\<|%3c]script[\\>|%3e]|javascript|alert|webscan|dbappsecurity|style|confirm\\(|innerhtml|innertext)(.*)$)",
        "operator":"≈",
        "name_operator":"*"
      }
    },
    "query_string_2":{
      "Args":{
        "value":"GLOBALS(=|\\[|\\%[0-9A-Z]{0,2})",
        "operator":"≈",
        "name_operator":"*"
      }
    },
    "query_string_3":{
      "Args":{
        "value":"_REQUEST(=|\\[|\\%[0-9A-Z]{0,2})",
        "operator":"≈",
        "name_operator":"*"
      }
    },
    "waf_cookie":{
      "Cookie":{
        "value":"\\.\\./|\\:\\$|\\$\\{|select.+(from|limit)|(?:(union(.*?)select))|having|rongjitest|sleep\\((\\s*)(\\d*)(\\s*)\\)|benchmark\\((.*)\\,(.*)\\)|base64_decode\\(|(?:from\\W+information_schema\\W)|(?:(?:current_)user|database|schema|connection_id)\\s*\\(|(?:etc\\/\\W*passwd)|into(\\s+)+(?:dump|out)file\\s*|group\\s+by.+\\(|xwork.MethodAccessor|(?:define|eval|file_get_contents|include|require|require_once|shell_exec|phpinfo|system|passthru|preg_\\w+|execute|echo|print|print_r|var_dump|(fp)open|alert|showmodaldialog)\\(|xwork\\.MethodAccessor|(gopher|doc|php|glob|file|phar|zlib|ftp|ldap|dict|ogg|data)\\:\\/|java\\.lang|\\$_(GET|post|cookie|files|session|env|phplib|GLOBALS|SERVER)\\[|\\<(iframe|script|body|img|layer|div|meta|style|base|object|input)|(onmouseover|onerror|onload)\\=",
        "operator":"≈",
        "name_operator":"*"
      }
    },
    "waf_url_args":{
      "Args":{
        "value":"\\.(svn|htaccess|bash_history|sql|ssh)|\\.(bak|inc|old|mdb|sql|backup|java|class)$|(vhost|bbs|host|wwwroot|www|site|root|hytop|flashfxp).*\\.rar|(phpmyadmin|jmx-console|jmxinvokerservlet)|java\\.lang|/(attachments|upimg|images|css|uploadfiles|html|uploads|templets|static|template|data|inc|forumdata|upload|includes|cache|avatar)/(\\\\w+).(php|jsp)",
        "operator":"≈",
        "name_operator":"*"
      }
    },
    "waf_post":{
      "Args":{
        "value":"select.+(from|limit)|(?:(union(.*?)select))|having|rongjitest|sleep\\((\\s*)(\\d*)(\\s*)\\)|benchmark\\((.*)\\,(.*)\\)|base64_decode\\(|(?:from\\W+information_schema\\W)|(?:(?:current_)user|database|schema|connection_id)\\s*\\(|(?:etc\\/\\W*passwd)|into(\\s+)+(?:dump|out)file\\s*|group\\s+by.+\\(|xwork.MethodAccessor|(?:define|eval|file_get_contents|include|require|require_once|shell_exec|phpinfo|system|passthru|preg_\\w+|execute|echo|print|print_r|var_dump|(fp)open|alert|showmodaldialog)\\(|xwork\\.MethodAccessor|(gopher|doc|php|glob|file|phar|zlib|ftp|ldap|dict|ogg|data)\\:\\/|java\\.lang|\\$_(GET|post|cookie|files|session|env|phplib|GLOBALS|SERVER)\\[|\\<(iframe|script|body|img|layer|div|meta|style|base|object|input)|(onmouseover|onerror|onload)\\=|\\sor\\s+",
        "operator":"≈",
        "name_operator":"*"
      }
    },
    "http_referer_509":{
      "Referer":{
        "value":"xsshs.cn|WebBench*|17ce.com|ApacheBench*",
        "operator":"≈"
      }
    },
    "query_string_7":{
      "Args":{
        "value":"[a-zA-Z0-9_]=http://",
        "operator":"≈",
        "name_operator":"*"
      }
    },
    "query_string_6":{
      "Args":{
        "value":"base64_(en|de)code\\(.*\\)",
        "operator":"≈",
        "name_operator":"*"
      }
    },
    "query_string_4":{
      "Args":{
        "value":"proc/self/environ",
        "operator":"≈",
        "name_operator":"*"
      }
    },
    "query_string_5":{
      "Args":{
        "value":"mosConfig_[a-zA-Z_]{1,21}(=|\\%3D)",
        "operator":"≈",
        "name_operator":"*"
      }
    },
    "method_444":{
      "Method":{
        "value":"HEAD",
        "operator":"="
      }
    },
    "query_string_13":{
      "Args":{
        "value":"b(lipitor|phentermin|pro[sz]ac|sandyauer|tramadol|troyhamby)b",
        "operator":"≈",
        "name_operator":"*"
      }
    },
    "request_uri_504":{
      "Args":{
        "value":"(cost\\()|(concat\\()|[+|(%20)]union[+|(%20)]|[+|(%20)]select[+|(%20)]|[+|(%20)]or[+|(%20)]|[+|(%20)]delete[+|(%20)]|[+|(%20)]insert[+|(%20)]",
        "operator":"≈",
        "name_operator":"*"
      }
    },
    "waf_args_1":{
      "Args":{
        "value":"\\.\\./|\\:\\$|\\$\\{|select.+(from|limit)|(?:(union(.*?)select))|having|rongjitest|sleep\\((\\s*)(\\d*)(\\s*)\\)|benchmark\\((.*)\\,(.*)\\)|base64_decode\\(|(?:from\\W+information_schema\\W)|(?:(?:current_)user|database|schema|connection_id)\\s*\\(|(?:etc\\/\\W*passwd)|into(\\s+)+(?:dump|out)file\\s*|group\\s+by.+\\(|xwork.MethodAccessor|(?:define|eval|file_get_contents|include|require|require_once|shell_exec|phpinfo|system|passthru|preg_\\w+|execute|echo|print|print_r|var_dump|(fp)open|alert|showmodaldialog)\\(|xwork\\.MethodAccessor|(gopher|doc|php|glob|file|phar|zlib|ftp|ldap|dict|ogg|data)\\:\\/|java\\.lang|\\$_(GET|post|cookie|files|session|env|phplib|GLOBALS|SERVER)\\[|\\<(iframe|script|body|img|layer|div|meta|style|base|object|input)|(onmouseover|onerror|onload)\\=",
        "operator":"≈",
        "name_operator":"*"
      }
    },
    "query_string_12":{
      "Args":{
        "value":"b(ambien|bluespill|cialis|cocaine|ejaculation|erectile)b",
        "operator":"≈",
        "name_operator":"*"
      }
    }
  },
  "dashboard_host":"",
  "response":{
    "demo_response_json":{
      "content_type":"application/json",
      "body":"{\"msg\":\"soms text\",\"status\":\"success\"}"
    },
    "firewall_html":{
      "content_type":"text/html",
      "body":"<html xmlns=\"http://www.w3.org/1999/xhtml\">\n<head>\n    <meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n    <title>网站防火墙</title>\n</head>\n<body style=\" background-color:#444; margin:0; font:14px/1.5 Microsoft Yahei, 宋体,sans-serif; color:#555;\">\n    <div style=\"margin: 0 auto; width:100%; padding-top:10rem;\">\n        <div style=\"width:62rem; margin: 0 auto;\">\n            <div\n                style=\" height:5rem; line-height:5rem; color:#fff; font-size:3rem; background:#6bb3f6;padding-left: 1rem;\">\n                网站防火墙 </div>\n            <div\n                style=\"border:1px dashed #cdcece; border-top:none; background:#fff; color:#555; height:15rem; padding:3rem 2rem 0 2rem; overflow-y:auto;background:#f3f7f9;\">\n                <span style=\" ; font-weight:600; font-size: 2.3rem; color:#fc4f03;\">您的请求带有不合法参数，已被防火墙自动拦截并记录\n                    !</span><br>\n                <p style=\" font-size: 2rem; -qt-block-indent:0; text-indent:0 px;\">\n                    可能原因：您提交的内容包含危险的请求</p>\n            </div>\n        </div>\n    </div>\n</body>\n</html>"
    },
    "ccdeny_html":{
      "content_type":"text/html",
      "body":"<!doctype html>\n<html>\n<head>\n<meta charset=\"utf-8\">\n<meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no\">\n<title>页面访问过快</title>\n<style>\n        body{\n                background-color:#444;\n                font-size:14px;\n        }\n        h3{\n                font-size:60px;\n                color:#eee;\n                text-align:center;\n                padding-top:30px;\n                font-weight:normal;\n        }\n</style>\n</head>\n\n<body>\n<h3>您访问过快, 请稍后再试</h3>\n</body>\n</html>\n"
    }
  },
  "config_version":"0.36"
}
